// MapFourTree.h: interface for the CMapFourTree class.
//
//////////////////////////////////////////////////////////////////////

#if !defined(AFX_MAPFOURTREE_H__D454C0B3_04B1_459D_826F_82F789C63888__INCLUDED_)
#define AFX_MAPFOURTREE_H__D454C0B3_04B1_459D_826F_82F789C63888__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

//四叉树节点结果
struct TreeNode4
{
	TreeNode4* m_child00;	//子00数据指针
	TreeNode4* m_child01;	//子01数据指针
	TreeNode4* m_child10;	//子10数据指针
	TreeNode4* m_child11;	//子11数据指针
	void*	   m_data;		//数据结构体
	TreeNode4()
	{
		m_child00 = NULL;	//子00的内存偏移地址
		m_child01 = NULL;	//子01的内存偏移地址
		m_child10 = NULL;	//子10的内存偏移地址
		m_child11 = NULL;	//子11的内存偏移地址
		m_data = NULL;		//数据地址
	}
	//添加子节点
	void AddTree00( TreeNode4* node )
	{
		m_child00 = node;
	}
	void AddTree01( TreeNode4* node )
	{
		m_child01 = node;
	}
	void AddTree10( TreeNode4* node )
	{
		m_child10 = node;
	}
	void AddTree11(  TreeNode4* node )
	{
		m_child11 = node;
	}
	//设置节点数据
	void SetNodeData( void* data )
	{
		m_data = data;
	}
	//只删除节点数据
	void DeleteNodeData()
	{
		if( m_data )
		{
			delete m_data;
			m_data = NULL;
		}
	}
	//清除索引
	void Clear()
	{
		if( m_data )
		{
			m_data = NULL;
		}
		//清除子节点数据
		if( m_child00 )
		{
			m_child00->Clear();
			delete m_child00;
			m_child00 = NULL;
		}
		if( m_child01 )
		{
			m_child01->Clear();
			delete m_child01;
			m_child01 = NULL;
		}
		if( m_child10 )
		{
			m_child10->Clear();
			delete m_child10;
			m_child10 = NULL;
		}
		if( m_child11 )
		{
			m_child11->Clear();
			delete m_child11;
			m_child11 = NULL;
		}
	}
	//删除所有数据
	void DeleteAll()
	{
		//清除数据
		if( m_data )
		{
			delete m_data;
			m_data = NULL;
		}
		//清除子节点数据
		if( m_child00 )
		{
			m_child00->DeleteAll();
			delete m_child00;
			m_child00 = NULL;
		}
		if( m_child01 )
		{
			m_child01->DeleteAll();
			delete m_child01;
			m_child01 = NULL;
		}
		if( m_child10 )
		{
			m_child10->DeleteAll();
			delete m_child10;
			m_child10 = NULL;
		}
		if( m_child11 )
		{
			m_child11->DeleteAll();
			delete m_child11;
			m_child11 = NULL;
		}
	}
};

//地图四叉树
class CMapFourTree  
{
public:
	CMapFourTree();
	virtual ~CMapFourTree();

	//创建四叉树
	void Create();
	//添加数据
	void AddData( long lDepth, long lNumX, long lNumY, void* data );

	//得到数据
	void* GetData( long lDepth, long lNumX, long lNumY );

	//删除节点数据，不删除子节点
	bool DeleteData( long lDepth, long lNumX, long lNumY );

	//清除所有节点
	void Clear();

	//删除所有数据
	void DeleteAll();
public:
	TreeNode4*    m_Tree4Root;
};

#endif // !defined(AFX_MAPFOURTREE_H__D454C0B3_04B1_459D_826F_82F789C63888__INCLUDED_)
